\chapter{Introducción}

Este Trabajo de Fin de Grado consiste en construir una solución software
capaz de exportar y visualizar información sobre la recolección de cultivos
leñosos haciendo uso de un sistema de control embebido.

Este proyecto es software libre, y está liberado con
la licencia \textbf{GNU Affero General Public License} \cite{agplv3}.

\section{Motivación}

En España existen 23.848.757 hectáreas de superficie agrícola utilizada%
\footnote{%
Según el INE, conjunto de la superficie de tierras labradas y tierras
para pastos permanentes.
}%
al aire libre, de las cuales \textbf{4.657.182 hectáreas se dedican a cultivos leñosos}
 \cite{INEdistribucionDeLaSuperficiePorTamaño}.
Entre estos predominan el cultivo del olivar, del viñedo, de los cítricos,
de los frutos secos como las almendras o los pistachos y otros frutales
 \cite{INEpanoramicaCensoAgrario}.

\begin{figure}[!b]
    \centering
    \includegraphics[width=\textwidth]{distribucion-SAU-segun-cultivo-aire-libre.png}
    \caption{\textit{Distribución general de la SAU al aire libre por hectáreas
    según \cite{INEdistribucionDeLaSuperficiePorTamaño}. Los territorios de Andalucía y Castilla-La Mancha
    acumulan aproximadamente el 62\% de los cultivos leñosos en territorio nacional.
    Elaboración propia.}}
\end{figure}

\subsection{Situación de las explotaciones agrícolas en España}

\textbf{La explotación} de la superficie agrícola utilizada \textbf{se realiza mayoritariamente por personas
físicas}. \textbf{Observamos un mayor número de sociedades mercantiles
a medida que aumenta el tamaño de explotación}, siendo el 30\% de quienes explotan los latifundios\footnote{%
    Consideramos que una explotación agrícola es un latifundio a partir de las 100 hectáreas.
}%
 en España
 \cite[Personalidad jurídica según el tamaño de explotación]{INEpanoramicaCensoAgrario}.

\textbf{No existe apenas una renovación de los jefes de explotación}%
\footnote{%
    Según Eustat, la persona física responsable de las actividades financieras y de producción, corrientes y cotidianas de una explotación agrícola.
}%
, con un porcentaje de gestores menores de 45 años
inferior al 40\% en todas las comarcas. La formación reglada específica de los jefes en el caso de
las explotaciones agrarias es inferior al 25\% en todas las comarcas españolas,
llegando a menos del 2,84\% regiones en las que predominan los cultivos leñosos
 \cite[Formación de los jefes de explotación]{INEpanoramicaCensoAgrario}.

\subsection{Gestión de las explotaciones de cultivos leñosos}

\begin{figure}[!b]
    \centering
    \includegraphics[width=\textwidth]{distribucion-SAU-segun-tamaño.png}
    \caption{\textit{Distribución general de la SAU por tamaño de la explotación según
    \cite{INEdistribucionDeLaSuperficiePorTamaño}. Apreciamos que, aunque es similar la
    proporción del número de explotaciones según el tamaño para la media de todos los tipos
    de cultivos y para los leñosos, la superficie ocupada para ambas categorías difiere
    significativamente. Elaboración propia.}}
\end{figure}

Encontramos la mayor superficie de cultivos leñosos en la mitad sur de la península,
destacando Andalucía, Castilla-La Mancha y Extremadura.
\cite[Reparto de la superficie dedicada a los grandes cultivos.]{INEpanoramicaCensoAgrario}

\textbf{Dos terceras partes del coste} de este tipo de cultivos \textbf{se destinan a la
recolección y a la poda}
 \cite{Mecaolivar}.
Entre las soluciones mecanizadas para la recolección encontramos principalmente
los vareadores eléctricos y los paraguas vibradores,
mientras que para la poda las tijeras eléctricas, las motosierras y
las trituradoras para motocultores.

El \textbf{encarecimiento de la mano de obra}, la \textbf{importación de producto de países con menor coste de
producción} y el \textbf{bajo nivel de automatización y de inversión} por parte
de los propietarios de las explotaciones agrarias probablemente sean 
algunas de las causas que hayan hecho que la rentabilidad de la que
hablábamos en el anterior apartado haya disminuido en los últimos años.

\subsection{Externalización de la recolecta de cultivos leñosos a empresas especializadas}

\textbf{Algunos jefes de explotación deciden externalizar la recolección
de sus cultivos a empresas especializadas}. Ocurre un problema en este
caso, y es que el jefe de explotación deja de tener la certeza de que la
recolección se ha realizado de forma correcta, y de que la cantidad de producto
recolectado es la que se espera. Este problema también se da en otros contextos,
como el de grandes fincas profesionalizadas.

\textbf{Nuestro cliente acude a nosotros para desarrollar una solución propia de
estadísticas de recolección en cultivos leñosos.}

\section{Problema a resolver}

\textbf{Buscamos describir de una forma clara y concisa el problema y sus
circunstancias}. Consideramos que el problema se describe de forma clara y
concisa cuando se enuncia con el mínimo nivel de complejidad posible%
%
\footnote{Aunque
no por ello debe ser insuficiente. Un mito extendido acerca de las metodologías ágiles
es que no necesitamos tener una idea clara del problema antes de empezar a desarrollar
una solución. Nada mas lejos de la verdad, lo que se busca con los métodos ágiles en la
fase de análisis es poner a prueba empíricamente que nuestro modelo del problema es fiel
a la realidad, y que el problema que estamos resolviendo es el correcto antes de proponer
una solución arquitectónica. Así se concibe en las publicaciones que iniciaron el hoy
degenerado movimiento. \cite{AgileBackToBasics}
}%
, el lenguaje que se utiliza es simple pero adecuado
en su contexto y no tiene sesgos hacia ninguna solución.

Existen empresas y trabajadores los cuales, a cambio de dinero, trabajan la
tierra de un tercero con su maquinaria.

\textbf{Quien contrata el servicio} quiere reportes/resúmenes acerca de la actividad
de la máquina dado un intervalo de tiempo. Quiere conocer, a partir de una fecha y hora de inicio y otra de final:

\begin{enumerate}[noitemsep,nolistsep]
   \item Tiempo medio y mediano entre vibraciones.
   \item Tiempo medio y mediano vibrando.
   \item Posición de los árboles vibrados.
   \item Tiempo de trabajo efectivo.
\end{enumerate}

\textbf{Tanto quien contrata el servicio como quien lo ejecuta} quieren tener una seguridad alta
en que los reportes/resúmenes son verdaderos y que no han sido modificados. Quieren poder consultar
los datos sin necesidad de conexión a Internet. Quieren poder comprobar la veracidad de los datos.

\textbf{El software tiene que poder ejecutarse en una plataforma \textit{hardware} ya distribuida en el mercado.}
Esto es así por motivos económicos y de soporte a clientes anteriores a esta actualización \textit{software}.
La maquinaria se controla mediante un sistema de control dedicado con las siguientes características:

\begin{itemize}[noitemsep,nolistsep]
   \item Microcontrolador Renesas RA6M1.
   \begin{itemize}[noitemsep,nolistsep]
      \item Arm® Cortex®-M4.
      \item 8kiB Data FLASH.
      \item 128kiB SRAM.
      \item USB2.0 FS.
   \end{itemize}
   \item Conexión mediante UART a un módulo HMI propietario.
   \item Conexión mediante SPI a FRAM Fujitsu \texttt{MB85RS16NPNF-G-JNERE1} de 4kiB.
   \item Posibilidad de conexión mediante SPI a un segundo módulo SOIC-8 que utilice la misma huella que la PCB.
   \item Módulo GNSS UBLOX CAM-M8Q.
   \item CAN 2.0.
\end{itemize}

\section{Objetivo}

Con este proyecto \textbf{queremos obtener un producto que genere informes
de trabajo de un paraguas vibrador}, de forma que permita tanto a
quien recolecta el fruto como al jefe de explotación tener información
acerca de una jornada de trabajo para certificar el trabajo realizado.

Concretamente, según vemos en la sección del problema a resolver,
buscamos \textbf{desarrollar
una solución software que permita registrar y visualizar
información sobre la recolección de cultivos
leñosos con paraguas vibradores según los criterios de nuestro cliente},
con la restricción de que el registro y el exportado pueda ejecutarse en
una plataforma hardware ya distribuida en el mercado.

\section{Estructura del documento}

Esta memoria refleja el proceso de desarrollo de la solución software.
Cada una de las secciones expuestas representa una etapa del desarrollo.
\textbf{Etapas posteriores se basan en las anteriores, y pueden corregirlas.}
Si se corrigen, lo indicamos.

\begin{enumerate}
    \item \textbf{Introducción.} Donde exponemos el problema a resolver,
    sus circunstancias actuales y los objetivos que se quieren alcanzar en rasgos generales.

    \item \textbf{Metodología.} Donde exponemos cómo abordamos el desarrollo del problema y su solución y por qué.
    Explicamos qué metodología seguimos, cómo estimamos el tiempo y los costes, cómo seguimos el progreso
    del proyecto y cómo registramos métricas para los objetivos del sexto capítulo de esta memoria.

    \item \textbf{Problema a resolver.} Donde describimos el problema de una forma clara y concisa.
    Enunciamos qué se quiere resolver, quién va a interactuar con el programa y en qué circunstancias
    se interactuaría con el programa.

    \item \textbf{Arquitectura del sistema.} Donde enumeramos distintas soluciones arquitectónicas
    plausibles y elegimos una de ellas junto al cliente.

    \item \textbf{Implementación.} Donde describimos cómo llevamos a cabo el desarrollo software
    de la solución propuesta.
    \begin{itemize}[noitemsep,nolistsep]
        \item Estimación de tiempo y costes.
        \item Escucha y registro de eventos.
        \item Almacenamiento en memoria persistente.
        \item Recuperación de memora persistente.
        \item Visualización de los datos.
    \end{itemize}

    \item \textbf{Comparación de los datos previos, durante y posteriores al desarrollo.} Donde evaluamos cómo de
    acertados fueron los análisis del tercer capítulo de esta memoria.

    \item \textbf{Conclusión.} Donde realizamos una visita crítica a las ideas de los puntos
    anteriores una vez finalizado el proyecto y exponemos nuevas ideas surgidas de la experiencia.
\end{enumerate}
